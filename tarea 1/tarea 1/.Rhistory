source("~/Universidad/2022-2/Series de tiempo/tarea 1/tarea 1/script (5).R", echo=TRUE)
#install.packages("rio")
library(rio)
library(tidyverse)
library(splines)
library(MASS)
library(lmtest)
library(forecast)
install.packages("forecast")
#install.packages("rio")
library(rio)
library(tidyverse)
library(splines)
library(MASS)
library(lmtest)
library(forecast)
library(LSTS)
install.packages("LSTS")
source("~/Universidad/2022-2/Series de tiempo/tarea 1/tarea 1/script (5).R", echo=TRUE)
MAPE(datos$Venta[1:96],datos$fitted10_c[1:96])
MAPE(datos$Venta[1:96],datos$fitted11_d[1:96])
aux <- boxcox(pred_10_c) #verosimilitud de los Lambda
aux
aux$x[aux$y == max(aux$y)] #el con mayor ver
new_data = datos[97:104,]
predi_1 = c(rep(NA,95), datos$Venta[96] ,predict(pred_10_c, newdata = new_data))
predi_2 = c(rep(NA,95), datos$Venta[96] ,predict(pred_11_d, newdata = new_data))
par(mfrow = c(2,1),bty = "n", las = 1)
plot(datos$Venta ~ datos$drift, type = "l")
lines(predi_1, col = "4")
plot(datos$Venta ~ datos$drift, type = "l")
lines(predi_2, col = "2")
par(mfrow = c(1,2),bty = "n", las = 1)
plot(pred_10_c$residuals, type = "l")
plot(pred_11_d$residuals, type = "l")
par(mfrow = c(2,1),bty = "n", las = 1)
plot(pred_10_c$residuals, type = "l")
plot(pred_11_d$residuals, type = "l")
#A simple vista, los residuos de ninguno de los modelos parecen ruido blanco.
#pero veamos su acf
acf(pred_10_c$residuals)
pacf(pred_10_c$residuals)
acf(pred_11_d$residuals)
pacf(pred_11_d$residuals)
source("TS.diag.R")
TS.diag(pred_10_c$residuals)
#A simple vista, los residuos de ninguno de los modelos parecen ruido blanco.
#pero veamos su acf
acf(pred_10_c$residuals)
pacf(pred_10_c$residuals)
acf(pred_11_d$residuals)
pacf(pred_11_d$residuals)
arima1 = auto.arima(pred_10_c$residuals)
arima2 = auto.arima(pred_11_d$residuals)
arima1
arima2
#para los residuos de ambos modelos nos sugiere un AR1, veamos que tal estos modelos.
par(mfrow = c(1,2),bty = "n", las = 1)
plot(pred_10_c$residuals, type = "l")
lines(arima1$fitted, col = 2)
plot(pred_11_d$residuals, type = "l")
lines(arima2$fitted, col = 2)
#para los residuos de ambos modelos nos sugiere un AR1, veamos que tal estos modelos.
par(mfrow = c(2,1),bty = "n", las = 1)
plot(pred_10_c$residuals, type = "l")
lines(arima1$fitted, col = 2)
plot(pred_11_d$residuals, type = "l")
lines(arima2$fitted, col = 2)
summary(arima1)
summary(arima1)
summary(arima2)
MAPE(pred_10_c$residuals,arima1$fitted)
MAPE(pred_11_d$residuals,arima2$fitted)
plot(arima1$residuals)
plot(arima2$residuals)
acf(arima1$residuals)
pacf(arima1$residuals)
acf(arima2$residuals)
pacf(arima2$residuals)
acf(arima1$residuals)
pacf(arima1$residuals)
TS.diag(arima1$residuals)
TS.diag(arima2$residuals)
TS.diag(arima1$residuals)
TS.diag(arima2$residuals)
arima3 = auto.arima(pred_10_c$residuals, d = 1)
arima4 = auto.arima(pred_11_d$residuals, d = 1)
TS.diag(arima3$residuals)
TS.diag(arima4$residuals)
TS.diag(arima3$residuals)
TS.diag(arima4$residuals)
a
pred_11_d
a$mean[1:8]
predi_final = predict(pred_11_d, newdata = new_data)+a$mean[1:8]
predi_final
predi_final_plot = c(rep(NA,95), datos$Venta[96] ,predi_final)
par(mfrow = c(1,1),bty = "n", las = 1)
plot(datos$Venta ~ datos$drift, type = "l")
lines(predi_final_plot, col = "4")
aux <- boxcox(pred_10_c) #verosimilitud de los Lambda
aux$x[aux$y == max(aux$y)] #el con mayor ver
new_data = datos[97:104,]
predi_1 = c(rep(NA,95), datos$Venta[96] ,predict(pred_10_c, newdata = new_data))
predi_2 = c(rep(NA,95), datos$Venta[96] ,predict(pred_11_d, newdata = new_data))
par(mfrow = c(2,1),bty = "n", las = 1)
plot(datos$Venta ~ datos$drift, type = "l")
lines(predi_1, col = "4")
plot(datos$Venta ~ datos$drift, type = "l")
lines(predi_2, col = "2")
plot(datos$Venta ~ datos$drift, type = "l", xlab = "Tiempo", ylab = "")
par(mfrow = c(2,1),bty = "n", las = 1)
plot(datos$Venta ~ datos$drift, type = "l", xlab = "Tiempo", ylab = "")
lines(predi_1, col = "4")
plot(datos$Venta ~ datos$drift, type = "l", xlab = "Tiempo", ylab = "")
lines(predi_2, col = "2")
par(mfrow = c(2,1),bty = "n", las = 1)
plot(datos$Venta ~ datos$drift, type = "l", xlab = "Tiempo", ylab = "", main = "Modelo 2")
lines(predi_1, col = "4")
plot(datos$Venta ~ datos$drift, type = "l", xlab = "Tiempo", ylab = "", main = "Modelo 1")
par(mfrow = c(2,1),bty = "n", las = 1, main = "IMG1")
plot(datos$Venta ~ datos$drift, type = "l", xlab = "Tiempo", ylab = "", main = "Modelo 2")
lines(predi_1, col = "4")
plot(datos$Venta ~ datos$drift, type = "l", xlab = "Tiempo", ylab = "", main = "Modelo 1")
lines(predi_2, col = "2")
par(mfrow = c(2,1),bty = "n", las = 1)
plot(pred_10_c$residuals, type = "l")
plot(pred_11_d$residuals, type = "l")
#A simple vista, los residuos de ninguno de los modelos parecen ruido blanco.
#pero veamos su acf
acf(pred_10_c$residuals)
pacf(pred_10_c$residuals)
acf(pred_11_d$residuals)
pacf(pred_11_d$residuals)
#A simple vista, los residuos de ninguno de los modelos parecen ruido blanco.
#pero veamos su acf
acf(pred_10_c$residuals)
pacf(pred_10_c$residuals)
arima1 = auto.arima(pred_10_c$residuals)
arima2 = auto.arima(pred_11_d$residuals)
arima1
arima2
arima1 = auto.arima(pred_10_c$residuals)
arima2 = auto.arima(pred_11_d$residuals)
arima2
arima1
#para los residuos de ambos modelos nos sugiere un AR1, veamos que tal estos modelos.
par(mfrow = c(2,1),bty = "n", las = 1)
plot(pred_10_c$residuals, type = "l")
lines(arima1$fitted, col = 2)
plot(pred_11_d$residuals, type = "l")
lines(arima2$fitted, col = 2)
summary(arima1)
summary(arima2)
MAPE(pred_10_c$residuals,arima1$fitted)
MAPE(pred_11_d$residuals,arima2$fitted)
plot(arima1$residuals)
plot(arima2$residuals)
acf(arima1$residuals)
pacf(arima1$residuals)
acf(arima2$residuals)
pacf(arima2$residuals)
TS.diag(arima1$residuals)
TS.diag(arima2$residuals)
arima3 = auto.arima(pred_10_c$residuals, d = 1)
arima4 = auto.arima(pred_11_d$residuals, d = 1)
TS.diag(arima3$residuals)
TS.diag(arima4$residuals)
arima3
arima4
